import{b as x,aU as k,cb as S,a2 as C,r as I,d as K,e as m,f as N,k as $,i as p,c as o,w as a,j as r,aX as g,H as w,C as u,a$ as R,x as U,y as V,cc as q,cd as B,ce as z}from"./index-8b922204.js";import{S as F}from"./auth-75c89bf5.js";const L=l=>(U("data-v-caf677fb"),l=l(),V(),l),T={class:"el-container is-vertical login-box login"},j=L(()=>p("header",{class:"el-header box-header"}," 登录 ",-1)),A={class:"el-main",style:{padding:"3px"}},D={class:"helper"},E={__name:"login",setup(l){const v=k(),h=S(),d=C(),f=I(),y={username:{required:!0,trigger:["blur","input"],message:"账号不能为空"},password:{required:!0,trigger:["blur","input"],message:"密码不能为空"}},s=K({username:"",password:"",loading:!1}),b=()=>{s.loading=!0;const t=F({account:s.username,password:s.password,platform:"web"});t.then(async e=>{e.code==200?(window.$message.success("登录成功"),B(e.data.access_token,e.data.expires_in),z.connect(),v.loadSetting(),d.push(h.query.redirect||"/")):window.$message.warning(e.message)}),t.finally(()=>{s.loading=!1})},c=t=>{t.preventDefault(),q(!0),f.value.validate(e=>{!e&&b()})};return(t,e)=>{const _=m("n-input"),i=m("n-button");return N(),$("section",T,[j,p("main",A,[o(r(R),{ref_key:"formRef",ref:f,size:"large",model:s,rules:y},{default:a(()=>[o(r(g),{path:"username","show-label":!1},{default:a(()=>[o(_,{placeholder:"邮箱/手机号",value:s.username,"onUpdate:value":e[0]||(e[0]=n=>s.username=n),onKeydown:w(c,["enter","native"])},null,8,["value","onKeydown"])]),_:1}),o(r(g),{path:"password","show-label":!1},{default:a(()=>[o(_,{placeholder:"请输入密码",type:"password","show-password-on":"click",value:s.password,"onUpdate:value":e[1]||(e[1]=n=>s.password=n),onKeydown:w(c,["enter","native"])},null,8,["value","onKeydown"])]),_:1}),o(i,{type:"primary",size:"large",block:"",class:"mt-t20",onClick:c,loading:s.loading},{default:a(()=>[u(" 立即登录 ")]),_:1},8,["loading"])]),_:1},8,["model"]),p("div",D,[o(i,{text:"",color:"#409eff",onClick:e[2]||(e[2]=n=>r(d).push("/auth/forget"))},{default:a(()=>[u(" 找回密码 ")]),_:1}),o(i,{text:"",color:"#409eff",onClick:e[3]||(e[3]=n=>r(d).push("/auth/register"))},{default:a(()=>[u(" 还没有账号？立即注册 ")]),_:1})])])])}}},X=x(E,[["__scopeId","data-v-caf677fb"]]);export{X as default};
