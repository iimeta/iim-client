import{b as S,a2 as K,r as h,d as $,bD as C,e as E,f as I,k as R,i as g,c as s,w as r,j as n,aX as c,aD as m,H as p,C as f,q as N,v as q,t as D,a$ as T,x as U,y as V}from"./index-9f644312.js";import{a as B}from"./auth-e79ee549.js";import{S as z,c as y,b as F}from"./common-78499294.js";const j=i=>(U("data-v-fd20f266"),i=i(),V(),i),G={class:"el-container is-vertical login-box reister"},H=j(()=>g("header",{class:"el-header box-header"},"注册",-1)),L={class:"el-main",style:{padding:"3px"}},M={class:"helper"},X={__name:"register",setup(i){const w=K(),v=h(),b={nickname:{required:!0,trigger:["blur","input"],message:"昵称不能为空"},username:{required:!0,validator(o,e){if(e){if(!y(e))return new Error("请正确填写邮箱")}else return new Error("邮箱不能为空");return!0},trigger:["blur","input"]},password:{required:!0,trigger:["blur","input"],message:"密码不能为空"},code:{required:!0,trigger:["blur","input"],message:"验证码不能为空"}},d=h(0),_=new z("REGISTER_SMS",60,o=>{d.value=o}),a=$({nickname:"",username:"",password:"",code:"",loading:!1}),k=()=>{a.loading=!0;const o=B({nickname:a.nickname,account:a.username,password:a.password,code:a.code,platform:"web"});o.then(e=>{e.code==200?(window.$message.success("注册成功"),setTimeout(()=>{w.push("/auth/login")},500)):window.$message.warning(e.message)}),o.finally(()=>{a.loading=!1})},l=o=>{o.preventDefault(),v.value.validate(e=>{!e&&k()})},x=()=>{if(!y(a.username)){window.$message.warning("请正确填写邮箱");return}const o=F({email:a.username,channel:"register"});o.then(e=>{e.code==200?(_.start(),window.$message.success("验证码发送成功"),e.data.is_debug&&(a.code=e.data.code,setTimeout(()=>{window.$message.success("已开启验证码自动填充")},1e3))):window.$message.warning(e.message)}),o.finally(()=>{a.loading=!1})};return C(()=>{_.clear()}),(o,e)=>{const u=E("n-button");return I(),R("section",G,[H,g("main",L,[s(n(T),{ref_key:"formRef",ref:v,size:"large",model:a,rules:b},{default:r(()=>[s(n(c),{path:"username","show-label":!1},{default:r(()=>[s(n(m),{placeholder:"请输入邮箱",value:a.username,"onUpdate:value":e[0]||(e[0]=t=>a.username=t),onKeydown:p(l,["enter","native"])},null,8,["value","onKeydown"])]),_:1}),s(n(c),{path:"code","show-label":!1},{default:r(()=>[s(n(m),{placeholder:"验证码",value:a.code,"onUpdate:value":e[1]||(e[1]=t=>a.code=t),maxlength:6,onKeydown:p(l,["enter","native"])},null,8,["value","onKeydown"]),s(u,{tertiary:"",class:"mt-l5",onClick:x,disabled:d.value>0},{default:r(()=>[f(" 获取验证码 "),N(g("span",null,"("+D(d.value)+"s)",513),[[q,d.value>0]])]),_:1},8,["disabled"])]),_:1}),s(n(c),{path:"nickname","show-label":!1},{default:r(()=>[s(n(m),{placeholder:"设置昵称",value:a.nickname,"onUpdate:value":e[2]||(e[2]=t=>a.nickname=t),maxlength:20,onKeydown:p(l,["enter","native"])},null,8,["value","onKeydown"])]),_:1}),s(n(c),{path:"password","show-label":!1},{default:r(()=>[s(n(m),{placeholder:"设置密码",type:"password","show-password-on":"click",value:a.password,"onUpdate:value":e[3]||(e[3]=t=>a.password=t),onKeydown:p(l,["enter","native"])},null,8,["value","onKeydown"])]),_:1}),s(u,{type:"primary",size:"large",block:"",class:"mt-t20",onClick:l,loading:a.loading},{default:r(()=>[f(" 立即注册 ")]),_:1},8,["loading"])]),_:1},8,["model"]),g("div",M,[s(u,{text:"",color:"#409eff",onClick:e[4]||(e[4]=t=>n(w).push("/auth/forget"))},{default:r(()=>[f(" 找回密码 ")]),_:1}),s(u,{text:"",color:"#409eff",onClick:e[5]||(e[5]=t=>n(w).push("/auth/login"))},{default:r(()=>[f(" 已有账号，立即登录? ")]),_:1})])])])}}},P=S(X,[["__scopeId","data-v-fd20f266"]]);export{P as default};
